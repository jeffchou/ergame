doctype html
//- basic libraries: jquery(1.10.2), d3js(3.3.11), angularjs(1.2.3), bootstrap(3.0)/semantic-ui(0.9.3/0.9.5)
//-                  fontawesome(4.4.0)
- var use = { cdn: false, og: false, favicon: true }
- var lib = { jquery: true, d3js: false, angular: true, bootstrap: true, semantic: false, fontawesome: true }
- var assets = "assets"
- var thumbnail = "img/thumbnail.jpg"
- var favicon = "img/favicon.png"
- var title = "急診人生 - 三分鐘的急診室醫師人生 / 報導者"
html(lang="en")
  head(prefix="og: http://ogp.me/ns#")
    meta(charset="utf-8")
    meta(name='viewport', content='width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=0.0')
    title= title
    // libraries
    include library.jade
    // custom files
    link(rel="stylesheet",type="text/css",href="index.css")
    script(type="text/javascript",src="scream.min.js")
    script(type="text/javascript",src="index.js")
  //-body(ng-app="ERGame",ng-controller="ERGame",ng-mouseup="mouse.up($event)",ng-mousedown="mouse.down($event)",
     ontouchstart="touch.down(event)", ontouchend="touch.up(event)")
  body(ng-app="ERGame",ng-controller="ERGame",ng-mouseup="mouse.up($event)",ng-mousedown="mouse.down($event)")
    #container
      #head
        img#logo(src="img/logo.png")
        .pull-right
          a(href="#"): img(src="img/fb.png")
          a(href="#"): img(src="img/twt.png")
      //-div(style="position:fixed;top:10px;left:10px;z-index:10000")
        | D1: {{debug.d1}}
        br
        | D2: {{debug.d2}}
        br
        | D3: {{debug.d3}}
        br
        | D4: {{debug.d4}}
        br
        | D5: {{debug.d5}}
        br
        | D6: {{debug.d6}}
      #frame: #wrapper
        #loading(ng-if="loading",ng-class="{'fade':progress.value >= 100}")
          #loading-fig
            img.base(src="img/load/shadow.png")
            #loading-progress(ng-attr-style="top:{{100 - progress.value}}%")
              img(src="img/load/doctor.png",ng-attr-style="top:-{{100 - progress.value}}%")
          #loading-percent {{progress.value}}&nbsp;%
          img#loading-text(src="img/load/text.png")
        #deg90(ng-if="dimension.portrait")
        #landing(ng-if="game.state==0")
          #landing-reporter
            img(src="img/cover/landing-reporter-0.png")
            img.active(src="img/cover/landing-reporter-1.png")
          #landing-start(ng-click="game.tutorial();audio.click()")
            img(src="img/cover/landing-start-0.png")
            img.active(src="img/cover/landing-start-1.png")
          #landing-skip(ng-click="dialog.skip();audio.click()")
            img(src="img/cover/landing-skip-0.png")
            img.active(src="img/cover/landing-skip-1.png")
        #countdown(ng-if="game.state==5")
          img(src="img/countdown/3.png",ng-if="game.countdown.value==4")
          img(src="img/countdown/2.png",ng-if="game.countdown.value==3")
          img(src="img/countdown/1.png",ng-if="game.countdown.value==2")
          img(src="img/countdown/go.png",ng-if="game.countdown.value==1")
        #pause(ng-if="game.state==1")
          #pause-link
            img(src="img/pause/link-0.png")
            img.active(src="img/pause/link-1.png")
          #pause-reporter
            img(src="img/pause/reporter-0.png")
            img.active(src="img/pause/reporter-1.png")
          #pause-facebook
            img(src="img/pause/fb-0.png")
            img.active(src="img/pause/fb-1.png")
          #pause-tutorial
            img(src="img/pause/tutorial-0.png")
            img.active(src="img/pause/tutorial-1.png")
          #pause-replay(ng-click="game.reset();audio.click()")
            img(src="img/pause/replay-0.png")
            img.active(src="img/pause/replay-1.png")
          #pause-tm
            img(src="img/pause/tm.png")
        #mute(ng-click="audio.toggleMute()")
          div(ng-if="audio.isMute")
            img(src="img/mute/x0.png")
            img.active(src="img/mute/x1.png")
          div(ng-if="!audio.isMute")
            img(src="img/mute/o0.png")
            img.active(src="img/mute/o1.png")
        #game-ctrl(ng-if="game.state>0")
          #gctrl-landing(ng-if="game.state==4",ng-mouseup="game.reset();audio.click();$event.preventDefault()")
            img(src="img/game/landing-0.png")
            img.active(src="img/game/landing-1.png")
          #gctrl-pause(ng-if="game.state==2",ng-mouseup="game.pause();audio.click();$event.preventDefault()")
            img(src="img/game/pause-0.png")
            img.active(src="img/game/pause-1.png")
          //-#gctrl-cont(ng-if="game.state==3 && dialog.show",ng-mousedown="blah();dialog.next();audio.click()",onclick="")
          #gctrl-cont(ng-if="game.state==3 && dialog.show",onclick="ctrl.next(false)",ontouchstart="ctrl.next(true)")
            img(src="img/game/cont-0.png")
            img.active(src="img/game/cont-1.png")
          //-#gctrl-skip(ng-if="game.state==3",ng-mouseup="dialog.skip(true);audio.click();$event.preventDefault()")
          #gctrl-skip(ng-if="game.state==3",onclick="ctrl.skip(false,event)",ontouchstart="ctrl.skip(true,event)")
            img(src="img/game/skip-0.png")
            img.active(src="img/game/skip-1.png")
          #gctrl-start(ng-if="game.state==1",ng-click="game.setState(2);audio.click();audio.bk()")
            img(src="img/game/start-0.png")
            img.active(src="img/game/start-1.png")
        #game-over(ng-if="game.state==4")
          #gover-reporter
            img(src="img/cover/over-report-0.png")
            img.active(src="img/cover/over-report-1.png")
          #gover-facebook
            img(src="img/cover/over-share-0.png")
            img.active(src="img/cover/over-share-1.png")
          #gover-rank
            img#govevr-rank-bas(src="img/lv/0.png")
            #gover-rank-active(ng-attr-style="left:{{doctor.rank * 14.746094}}%")
              img(src="img/lv/8.png",ng-attr-style="left:-{{doctor.rank * 125.5}}%")
          .score
            each val in [0,1,2,3]
              .score-digit(ng-attr-style="background-image:url(img/gauge/{{doctor.score.digit["+val+"]}}s.png)")
        #danger(ng-class="{'active':danger}"): img(src="img/danger.png",draggable="false")
        #urgency(ng-class="{'active':patient.urgent}")
        #energy(ng-class="{'active':doctor.draining>0}")
          #energy-base
            img(src="img/gauge/energy-0.png")
          #energy-current(ng-attr-style="left:-{{(1 - doctor.energy) * 99 + 1.0738255}}%")
            img(src="img/gauge/energy-5.png",ng-attr-style="left:{{(1 - doctor.energy) * 99 + 1.0738255}}%")
        #chance(ng-class="{'active':doctor.hurting>0}")
          each val in [1,2,3,4,5]
            .chance-node(ng-class="{'active':doctor.chance >="+val+"}")
        #score
          each val in [0,1,2,3]
            .score-digit(ng-attr-style="background-image:url(img/gauge/{{doctor.score.digit["+val+"]}}s.png)")
        #block-mask(ng-if="doctor.faint || madmax")
          .type(ng-if="doctor.faint && !madmax")
            img(src="img/mad/hungry1.png")
            img(src="img/mad/hungry2.png")
          .type(ng-if="madmax==1")
            img(src="img/mad/gangster1.png")
            img(src="img/mad/gangster2.png")
          .type(ng-if="madmax==2")
            img(src="img/mad/hysteria1.png")
            img(src="img/mad/hysteria2.png")
          #click-indicator
            img(src="img/mad/click-1.png")
            img(src="img/mad/click-2.png")
          #block-progress: div(ng-attr-style="width:{{doctor.demading}}%")
        #arrow
          img(src="img/arrow.png",draggable="false")
        #finger-slide
          img(src="img/tutorial/finger1.png",draggable="false")
          img(src="img/tutorial/finger2.png",draggable="false")
          img(src="img/wheel.png",draggable="false")
        #finger-tap
          img(src="img/tutorial/finger1.png",draggable="false")
          img(src="img/tutorial/finger2.png",draggable="false")
        #dialog(ng-class="dialog.type")
          img#dialog-content(ng-attr-src="img/tutorial/{{dialog.idx}}.png")
          img#dialog-doctor(src="img/tutorial/doctor.png")
        img#wheel(src="img/wheel.png",draggable="false")
        img(src="img/scenario.png",style="width:100%",draggable="false")
        .sprite(ng-repeat="pat in percent.sprite.points",
        ng-attr-style="width:{{percent.sprite.size[pat.type].w}}%;height:{{percent.sprite.size[pat.type].h}}%;"+
        "left:{{pat.x}}%;top:{{pat.y}}%",draggable="false",ng-class="pat.cls")
          .base(draggable="false")
          .normal(draggable="false")
          .active(ng-if="pat.type==1 && pat.active==1",ng-class="{'blink': pat.life < 0.3 && pat.variant != 0}",
          ng-attr-style="height:{{100 * (1 - pat.life)}}%",draggable="false")
            img(ng-attr-src="img/it-{{pat.type}}-{{pat.variant || 0}}-{{pat.active || 0}}.png",draggable="false")

          .active(ng-if="pat.type>=2 && pat.type<=4 && pat.active==1",ng-class="{'blink':pat.mad > 0.6 && pat.mad < 0.8}",
          ng-attr-style="top:{{100 * (1 - pat.mad)}}%",draggable="false")
            img(ng-attr-src="img/it-{{pat.type}}-{{pat.variant || 0}}-{{pat.active || 0}}.png",draggable="false",
            ng-attr-style="position:absolute;top:-{{100 * (1 - pat.mad)}}%")

          .active(ng-if="pat.type>=5 && pat.type<=8 && pat.active==1",ng-class="{'blink':pat.countdown < 0.4}",
          draggable="false")
            img(ng-attr-src="img/it-{{pat.type}}-{{pat.variant || 0}}-{{pat.active || 0}}.png",draggable="false")
      #foot
        a.pull-left(href="#"): img(src="img/about.png")
        a.pull-right(href="#"): img(src="img/github.png")
      #minimal-fix &nbsp;
      #img-preloader
